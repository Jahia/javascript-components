{"version":3,"names":["React","registry","count","getRenderWrapper","Render","RenderWrapper","_ref","context","otherProps","_objectWithoutProperties","_excluded","createElement","_extends","DisplayAction","_React$PureComponent","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","id","actionKey","render","_createClass","key","value","_this$props","loading","_excluded2","action","get","console","warn","Component","component","mergedProps","_objectSpread","componentProps","originalContext","init","PureComponent","_defineProperty","_pt","string","isRequired","object"],"sources":["DisplayAction.tsx"],"sourcesContent":["import React from 'react';\nimport {registry} from '~/registry';\nimport {StoredService} from '~/registry/service';\n\nlet count = 0;\n\nexport type DisplayActionProps = {\n    /**\n     * The key of the action to display\n     */\n    actionKey: string,\n    /**\n     * The action context\n     */\n    context?: object,\n    /**\n     * The render component\n     */\n    render: React.FunctionComponent<object>,\n    /**\n     * The render component\n     */\n    loading?: React.FunctionComponent<object>\n\n    [key: string]: unknown\n}\n\nconst getRenderWrapper = (Render: React.FunctionComponent): React.FunctionComponent => {\n    const RenderWrapper = ({context, ...otherProps}: React.PropsWithChildren<{context: object}>) => (\n        <Render {...context} {...otherProps}/>\n    );\n\n    return RenderWrapper;\n};\n\nclass DisplayAction extends React.PureComponent<DisplayActionProps> {\n    id: string;\n    RenderWrapper: React.FunctionComponent;\n\n    constructor(props: DisplayActionProps) {\n        super(props);\n        this.id = props.actionKey + '-' + (count++);\n        this.RenderWrapper = getRenderWrapper(props.render);\n    }\n\n    render() {\n        const {context, actionKey, render, loading, ...otherProps} = this.props;\n        const action: StoredService & { init?: ((ctx: object, props: object) => void)} = registry.get('action', actionKey);\n\n        if (!action) {\n            return null;\n        }\n\n        if (context) {\n            console.warn('Warn : context in DisplayAction is deprecated', actionKey, context);\n        }\n\n        const Component = (typeof action.component === 'function') ? action.component : render;\n\n        // Merge props and context. To remove when context is not supported anymore\n        const mergedProps = {...context, ...otherProps};\n\n        const componentProps = {...action, ...mergedProps, originalContext: mergedProps, id: this.id, actionKey};\n\n        if (componentProps.init) {\n            componentProps.init(componentProps, this.props);\n        }\n\n        // Props are passed as as context and props. Context can be removed when not supported anymore\n        return (\n            <Component\n                key={this.id}\n                {...componentProps}\n                context={componentProps}\n                render={this.RenderWrapper}\n                loading={loading}\n            />\n        );\n    }\n}\n\nexport {DisplayAction};\n"],"mappings":"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"}